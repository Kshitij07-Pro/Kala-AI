<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalā-AI Story Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div id="login-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50">
        <div class="bg-[#2a2a2a] p-8 rounded-xl shadow-2xl w-full max-w-sm border border-amber-900/50">
            <div id="login-view">
                <h2 data-translate-key="loginTitle" class="font-handcrafted text-5xl text-[#F5F5DC] mb-2">Welcome Back</h2>
                <p data-translate-key="loginSubtitle" class="text-gray-400 mb-6">Please sign in to continue</p>
                <form id="login-form">
                    <input id="login-email" type="email" placeholder="Email" class="w-full bg-gray-800/50 border border-amber-800/50 rounded-lg p-3 mb-4 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500" required autocomplete="off">
                    <input id="login-password" type="password" placeholder="Password" class="w-full bg-gray-800/50 border border-amber-800/50 rounded-lg p-3 mb-6 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500" required autocomplete="new-password">
                    <button data-translate-key="loginButton" type="submit" class="bg-[#a0522d] text-white font-bold tracking-wider py-3 px-10 rounded-lg hover:bg-[#b86136] transition-all duration-300 w-full">LOGIN</button>
                </form>
                <p class="text-gray-500 text-sm mt-2 text-center">
                    <span data-translate-key="loginNoAccount">Don't have an account?</span> <a href="#" id="show-signup" class="text-amber-500 hover:underline"><span data-translate-key="loginSignupLink">Sign Up</span></a>
                </p>
            </div>
            <div id="signup-view" class="hidden">
                <h2 data-translate-key="signupTitle" class="font-handcrafted text-5xl text-[#F5F5DC] mb-2">Create Account</h2>
                <p data-translate-key="signupSubtitle" class="text-gray-400 mb-6">Join the Kalā-AI community</p>
                <form id="signup-form">
                    <input id="signup-name" type="text" placeholder="Name" class="w-full bg-gray-800/50 border border-amber-800/50 rounded-lg p-3 mb-4 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500" required autocomplete="name">
                    <input id="signup-email" type="email" placeholder="Email Address" class="w-full bg-gray-800/50 border border-amber-800/50 rounded-lg p-3 mb-4 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500" required autocomplete="email">
                    <input id="signup-password" type="password" placeholder="Password" class="w-full bg-gray-800/50 border border-amber-800/50 rounded-lg p-3 mb-6 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500" required autocomplete="new-password">
                    <button data-translate-key="signupButton" type="submit" class="bg-[#a0522d] text-white font-bold tracking-wider py-3 px-10 rounded-lg hover:bg-[#b86136] transition-all duration-300 w-full">SIGN UP</button>
                </form>
                 <p class="text-gray-500 text-sm mt-4">
                    <span data-translate-key="signupHaveAccount">Already have an account?</span> <a href="#" id="show-login" class="text-amber-500 hover:underline"><span data-translate-key="signupLoginLink">Login</span></a>
                </p>
            </div>
            
            <div class="mt-6">
                <div class="relative">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-amber-800/50"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span data-translate-key="socialDivider" class="px-2 bg-[#2a2a2a] text-gray-500">Or continue with</span>
                    </div>
                </div>
                <div class="mt-4">
                    <button id="google-login" class="w-full inline-flex justify-center items-center py-2 px-4 border border-gray-700 rounded-md shadow-sm bg-gray-800 text-sm font-medium text-gray-300 hover:bg-gray-700">
                        <svg class="w-5 h-5 mr-2" aria-hidden="true" fill="currentColor" viewBox="0 0 48 48">
                            <path d="M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"/>
                        </svg>
                        Google
                    </button>
                </div>
                 <p id="auth-error" class="text-red-400 text-sm mt-4 hidden"></p>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden w-full max-w-4xl mx-auto">
        <header class="w-full flex justify-end items-center py-4 px-6 absolute top-0 right-0 z-10">
             <div class="relative" id="user-menu-button">
                <button class="flex items-center space-x-2 bg-black/20 p-2 rounded-lg border border-amber-900/30">
                    <span id="user-display-name" class="text-amber-300"></span>
                    <svg class="w-5 h-5 text-amber-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                </button>
                <div id="user-menu" class="hidden absolute right-0 mt-2 w-56 bg-[#2a2a2a] rounded-md shadow-lg py-1 border border-amber-900/50 z-20">
                    <div class="px-4 py-2 border-b border-amber-900/30">
                        <p class="text-sm text-gray-400">Signed in as</p>
                        <p id="user-email-display" class="text-sm font-medium text-white truncate"></p>
                    </div>
                    <button id="logout-button" data-translate-key="logoutButton" class="block w-full text-left px-4 py-2 text-sm text-red-300 hover:bg-red-800/50">Logout</button>
                </div>
            </div>
        </header>

        <main class="w-full max-w-3xl mx-auto">
             <div class="text-center mb-10 fade-in pt-16">
                 <div class="inline-flex items-center space-x-4 p-4 bg-black/10 backdrop-blur-sm rounded-lg">
                     <h1 data-translate-key="appTitle" class="font-handcrafted text-6xl md:text-7xl text-[#F5F5DC] tracking-wide">Kalā-AI</h1>
                     <select id="language-selector" class="cursor-pointer bg-gray-800/50 border border-amber-800/60 rounded-lg p-2 text-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-500">
                        <option value="en">English</option>
                        <option value="hi">हिन्दी</option>
                        <option value="bn">বাংলা</option>
                        <option value="ta">தமிழ்</option>
                        <option value="te">తెలుగు</option>
                        <option value="mr">मराठी</option>
                        <option value="gu">ગુજરાતી</option>
                    </select>
                </div>
                <p data-translate-key="appSubtitle" class="text-gray-400 mt-4 text-lg">Bring your artisan crafts to life.</p>
            </div>

            <div class="flex flex-col gap-8">
                <div class="fade-in" style="animation-delay: 0.2s;">
                    <h3 data-translate-key="uploadTitle" class="font-handcrafted text-3xl text-amber-300 mb-2">1. Upload Image</h3>
                    <div id="image-upload-area" class="border-2 border-dotted border-amber-800/60 rounded-xl p-6 text-center transition-all duration-300 bg-black/10 backdrop-blur-sm">
                        <input type="file" id="image-upload-input" class="hidden" accept="image/*">
                        <div id="image-preview-container" class="hidden relative">
                            <img id="preview-img" class="max-h-64 mx-auto rounded-lg shadow-md" alt="Image preview">
                            <div class="absolute top-2 right-2 flex space-x-2">
                                <button id="change-image-button" data-translate-key="changeButton" class="bg-gray-800/70 text-white text-xs px-3 py-1 rounded-full hover:bg-gray-700 transition-colors">Change</button>
                                <button id="remove-image-button" data-translate-key="removeButton" class="bg-red-800/70 text-white text-xs px-3 py-1 rounded-full hover:bg-red-700 transition-colors">Remove</button>
                            </div>
                        </div>
                        <div id="upload-prompt" class="cursor-pointer">
                            <svg class="mx-auto h-12 w-12 text-[#ab7a54]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                            </svg>
                            <p id="upload-text">
                                <span data-translate-key="uploadLink" class="font-semibold text-amber-500">Choose a file</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="fade-in" style="animation-delay: 0.4s;">
                    <h3 data-translate-key="storyTitle" class="font-handcrafted text-3xl text-amber-300 mb-2">2. Tell Your Story</h3>
                    <div class="bg-black/10 backdrop-blur-sm rounded-xl border border-amber-800/60 p-4 relative">
                        <textarea id="typed-story-input" rows="5" data-translate-key="storyPlaceholder" placeholder="Start typing your story here, or click the mic to record..." class="w-full bg-gray-800/50 border-none rounded-lg p-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500"></textarea>
                        <div id="recording-controls" class="absolute right-4 bottom-3 flex items-center space-x-2">
                             <div id="recording-status" class="text-gray-400 hidden items-center space-x-2">
                                <span class="w-3 h-3 bg-red-600 rounded-full pulse"></span>
                                <span id="recording-timer" class="text-sm">0:00</span>
                            </div>
                            <button id="record-button" class="w-10 h-10 bg-red-800 rounded-full flex items-center justify-center hover:bg-red-700 transition-colors shadow-lg">
                                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path fill-rule="evenodd" d="M5.5 8.5A.5.5 0 016 8v2a4 4 0 108 0V8a.5.5 0 011 0v2a5 5 0 11-10 0V8.5z" clip-rule="evenodd"></path></svg>
                            </button>
                            <button id="stop-button" class="hidden w-10 h-10 bg-gray-700 rounded-full flex items-center justify-center hover:bg-gray-600 transition-colors shadow-lg">
                                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10a.5.5 0 01.5-.5h9a.5.5 0 010 1h-9A.5.5 0 015 10z"></path></svg>
                            </button>
                        </div>
                    </div>
                    <div id="audio-playback" class="hidden w-full mt-4">
                        <p data-translate-key="audioSuccess" class="text-green-400 mb-2">✓ Story Recorded</p>
                        <audio id="audio-player" controls class="w-full"></audio>
                    </div>
                </div>
            </div>

            <div class="text-center mb-8 mt-16 fade-in space-x-4" style="animation-delay: 0.6s;">
                <button id="generate-button" data-translate-key="generateButton" class="bg-[#a0522d] text-white font-bold tracking-wider py-3 px-10 rounded-lg hover:bg-[#b86136] hover:shadow-xl hover:shadow-amber-900/20 transition-all duration-300 shadow-lg focus:outline-none focus:ring-4 focus:ring-amber-500/50 disabled:bg-gray-700 disabled:cursor-not-allowed disabled:shadow-none">
                    GENERATE STORY
                </button>
                <button id="refresh-button" data-translate-key="refreshButton" class="hidden bg-gray-600 text-white font-bold tracking-wider py-3 px-10 rounded-lg hover:bg-gray-700 transition-all duration-300 shadow-lg focus:outline-none focus:ring-4 focus:ring-gray-500/50">
                    START NEW STORY
                </button>
            </div>

            <div id="result-container" class="hidden mt-8 fade-in bg-black/20 backdrop-blur-sm rounded-xl p-6" style="animation-delay: 0.8s;">
                <div id="loader" class="hidden mx-auto spinner"></div>
                <div id="error-message" class="hidden bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-lg" role="alert"></div>
                <div id="story-output" class="hidden prose prose-invert max-w-none prose-h2:font-handcrafted prose-h2:text-4xl prose-h2:text-amber-300 prose-p:text-gray-300 prose-ul:list-disc prose-li:ml-4">
                </div>
                 <div class="mt-6 text-center">
                    <button id="post-button" data-translate-key="postButton" class="hidden bg-green-700 text-white font-bold tracking-wider py-2 px-6 rounded-lg hover:bg-green-800 transition-all duration-300 shadow-lg">
                        Share Story
                    </button>
                    <div id="social-share-links" class="hidden mt-4 flex justify-center items-center space-x-4">
                        <a id="twitter-share" href="#" target="_blank" class="p-2 bg-gray-700 rounded-full hover:bg-gray-600"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
                        <a id="facebook-share" href="#" target="_blank" class="p-2 bg-gray-700 rounded-full hover:bg-gray-600"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5V12h3.642l.358-4H14V6.037c0-.92.64-1.103 1.06-1.103H17V.03L13.883.012C10.732.012 9 1.93 9 5.037V8z"/></svg></a>
                          <a id="whatsapp-share" href="#" target="_blank" class="p-2 bg-gray-700 rounded-full hover:bg-gray-600"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.38 1.25 4.85L2 22l5.3-1.38c1.41.75 3 1.17 4.7 1.17h.01c5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zM18.1 16.39c-.27-.13-1.61-.79-1.85-.88-.25-.09-.43-.13-.62.13-.19.27-.7.88-.86 1.06-.16.19-.32.21-.59.08s-1.14-.42-2.17-1.34c-.81-.72-1.35-1.61-1.51-1.88-.16-.27-.02-.42.12-.55.12-.12.27-.31.4-.43.14-.13.19-.22.29-.38.1-.16.05-.31-.03-.43s-.62-1.49-.84-2.04c-.23-.55-.46-.48-.62-.48-.16 0-.34-.01-.52-.01-.19 0-.48.08-.74.34-.26.27-.98.96-.98 2.34 0 1.38 1 2.71 1.14 2.91.13.19 1.98 3.19 4.81 4.25 2.83 1.06 2.83.71 3.34.68.5-.03 1.61-.66 1.83-1.28.23-.62.23-1.15.16-1.28l-.27-.13z"/></svg></a>
                          <a id="email-share" href="#" class="p-2 bg-gray-700 rounded-full hover:bg-gray-600"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0l-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z"/></svg></a>
                          <button id="copy-button" class="p-2 bg-gray-700 rounded-full hover:bg-gray-600"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></button>
                    </div>
                    <p id="copy-success-message" data-translate-key="copySuccess" class="hidden text-green-400 mt-2 text-sm">✓ Copied to clipboard!</p>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
    
</body>
</html>